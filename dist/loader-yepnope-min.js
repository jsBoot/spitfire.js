/*
 <a href="http://en.wikipedia.org/wiki/MIT_License">MIT</a>.
 @copyright All rights reserved <a href="http://www.webitup.fr">copyright WebItUp <dev@webitup.fr> (http://www.webitup.fr/lab)</a>
 @name loader.js
 @location https://github.com/jsBoot/spitfire.js/blob/master/src/loader.js#111-0f8cc49a5082f7c6a0ca6ae84a9d585ad117fcd2
*/
(function(l,e,u){function r(a){return!a||"loaded"==a||"complete"==a||"uninitialized"==a}function s(){var a=n.shift();v=1;a?a.t?m(function(){("c"==a.t?p.injectCss:p.injectJs)(a.s,0,a.a,a.x,a.e,1)},0):(a(),s()):v=0}function z(a,b,c,d,l,L,h){function C(f){if(!D&&r(k.readyState)&&(g.r=D=1,!v&&s(),k.onload=k.onreadystatechange=null,f)){"img"!=a&&m(function(){E.removeChild(k)},50);for(var c in q[b])if(q[b].hasOwnProperty(c))q[b][c].onload()}}h=h||p.errorTimeout;var k=e.createElement(a),D=0,A=0,g={t:c,s:b,
e:l,a:L,x:h};1===q[b]&&(A=1,q[b]=[]);"object"==a?k.data=b:(k.src=b,k.type=a);k.width=k.height="0";k.onerror=k.onload=k.onreadystatechange=function(){C.call(this,A)};n.splice(d,0,g);"img"!=a&&(A||2===q[b]?(E.insertBefore(k,F?null:t),m(C,h)):q[b].push(k))}function c(a,b,c,d,e){v=0;b=b||"j";w(a)?z("c"==b?M:G,a,b,this.i++,c,d,e):(n.splice(this.i++,0,a),1==n.length&&s());return this}function b(){var a=p;a.loader={load:c,i:0};return a}var d=e.documentElement,m=l.setTimeout,t=e.getElementsByTagName("script")[0],
g={}.toString,n=[],v=0,x=function(){},H="MozAppearance"in d.style,F=H&&!!e.createRange().compareNode,E=F?d:t.parentNode,d=l.opera&&"[object Opera]"==g.call(l.opera),d=!!e.attachEvent&&!d,G=H?"object":d?"script":"img",M=d?"script":G,I=Array.isArray||function(a){return"[object Array]"==g.call(a)},w=function(a){return"string"==typeof a},y=function(a){return"[object Function]"==g.call(a)},B=[],q={},J={timeout:function(a,b){b.length&&(a.timeout=b[0]);return a}},K,p;p=function(a){function c(a){a=a.split("!");
var b=B.length,d=a.pop(),e=a.length,d={url:d,origUrl:d,prefixes:a},m,f,g;for(f=0;f<e;f++)g=a[f].split("="),(m=J[g.shift()])&&(d=m(d,g));for(f=0;f<b;f++)d=B[f](d);return d}function d(a,k,e,m,g){var f=c(a),h=f.autoCallback;f.url.split(".").pop().split("?").shift();if(!f.bypass){k&&(k=y(k)?k:k[a]||k[m]||k[a.split("/").pop().split("?")[0]]);if(f.instead)return f.instead(a,k,e,m,g);q[f.url]?f.noexec=!0:q[f.url]=1;e.load(f.url,f.forceCSS||!f.forceJS&&"css"==f.url.split(".").pop().split("?").shift()?"c":
u,f.noexec,f.attrs,f.timeout);(y(k)||y(h))&&e.load(function(){b();k&&k(f.origUrl,g,m);h&&h(f.origUrl,g,m);q[f.url]=2})}}function e(a,b){function c(a,g){if(!a)!g&&l();else if(w(a))g||(f=function(){var a=[].slice.call(arguments);h.apply(this,a);l()}),d(a,f,b,0,m);else if(Object(a)===a)for(n in t=function(){var b=0,d;for(d in a)a.hasOwnProperty(d)&&b++;return b}(),a)a.hasOwnProperty(n)&&(g||--t||(y(f)?f=function(){var a=[].slice.call(arguments);h.apply(this,a);l()}:f[n]=function(a){return function(){var b=
[].slice.call(arguments);a&&a.apply(this,b);l()}}(h[n])),d(a[n],f,b,n,m))}var m=!!a.test,g=a.load||a.both,f=a.callback||x,h=f,l=a.complete||x,t,n;c(m?a.yep:a.nope,!!g);g&&c(g)}var m,g,h=this.yepnope.loader;if(w(a))d(a,0,h,0);else if(I(a))for(m=0;m<a.length;m++)g=a[m],w(g)?d(g,0,h,0):I(g)?p(g):Object(g)===g&&e(g,h);else Object(a)===a&&e(a,h)};p.addPrefix=function(a,b){J[a]=b};p.addFilter=function(a){B.push(a)};p.errorTimeout=1E4;null==e.readyState&&e.addEventListener&&(e.readyState="loading",e.addEventListener("DOMContentLoaded",
K=function(){e.removeEventListener("DOMContentLoaded",K,0);e.readyState="complete"},0));l.yepnope=b();l.yepnope.executeStack=s;l.yepnope.injectJs=function(a,b,d,c,g,l){var h=e.createElement("script"),n,k;c=c||p.errorTimeout;h.src=a;for(k in d)h.setAttribute(k,d[k]);b=l?s:b||x;h.onreadystatechange=h.onload=function(){!n&&r(h.readyState)&&(n=1,b(),h.onload=h.onreadystatechange=null)};m(function(){n||(n=1,b(1))},c);g?h.onload():t.parentNode.insertBefore(h,t)};l.yepnope.injectCss=function(a,b,d,c,g,n){c=
e.createElement("link");var h;b=n?s:b||x;c.href=a;c.rel="stylesheet";c.type="text/css";for(h in d)c.setAttribute(h,d[h]);g||(t.parentNode.insertBefore(c,t),m(b,0))}})(this,document);
(function(){var l;"undefined"!=typeof head&&(l=function(){return function(c,b){c.push(b);return head.js.apply(head.js,c)}});"undefined"!=typeof YUI&&(l=function(){var c;YUI().use("get",function(b){c=b});c.Get.options.async=!0;return function(){c.Get.js.apply(c.Get,arguments)}});"undefined"!=typeof yepnope&&(l=function(){return function(c,b){var d=c[c.length-1];yepnope({load:c,callback:function(c){d==c&&b()}})}});"undefined"!=typeof requirejs&&(l=function(){return function(c,b){requirejs(c,b)}});var e;
"undefined"!=typeof $LAB&&(e=function(){var c=$LAB.sandbox();this.script=function(b){c=c.script(b);return this};this.wait=function(b){c=b?c.wait(b):c.wait();return this}});e||(e=function(){var c=null,b=[],d=!1,m=l(),e=function(){if(!d&&(d=b.shift()))if(d.uris.length)m(d.uris,function(b){var c=d.callback;d=!1;c&&c(b);e()});else{var c=d.callback;d=!1;c&&c();e()}};this.script=function(d){c&&clearTimeout(c);b.length||b.push({uris:[],callback:!1});b[b.length-1].uris.push(d);c=setTimeout(e,1);return this};
this.wait=function(c){var e=b.length?b[b.length-1]:!1;d&&(e=d);if(!e)return c&&c(),this;e.callback?b.push({uris:[],callback:c}):(e.callback=c,b.push({uris:[],callback:!1}));return this}});e.prototype.fork=function(){return new e};e.prototype.base=function(c){var b=document.getElementsByTagName("script"),d;c=RegExp(c);for(var e=0,l;e<b.length;l=b[e].getAttribute("src"),e++)if(l&&c.test(l)){d=l.split("/");d.pop();d=d.join("/")||"./";break}return d||null};var u=1,r=null;e.prototype.style=function(c,
b){var d=document.getElementsByTagName("head")[0],e=document.createElement("link");e.setAttribute("type","text/css");e.setAttribute("rel","stylesheet");e.setAttribute("data-spitfire-index",u);b&&e.setAttribute("media",b);e.setAttribute("href",c);r||(r=d.lastChild);r&&r.nextSibling?d.insertBefore(e,r.nextSibling):d.appendChild(e);r=e;u++};var s="function"===typeof define&&define.amd,z="object"==typeof exports&&exports;s||z?s&&define("Spitfire/loader",new e):("Spitfire"in this||(this.Spitfire={}),this.Spitfire.loader=
new e)}).apply(this);
