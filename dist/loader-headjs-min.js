/*
 <a href="http://en.wikipedia.org/wiki/MIT_License">MIT</a>.
 @copyright All rights reserved <a href="http://www.webitup.fr">copyright WebItUp</a>
 @name https://github.com/jsBoot/spitfire.js/blob/master/src/loader.js#61-cf5eb006aad1e3ff52667ff791884991903ded05
*/
'use strict';(function(f,l){function m(){}function i(a,b){if(a){typeof a==="object"&&(a=[].slice.call(a));for(var d=0,e=a.length;d<e;d++)b.call(a,a[d],d)}}function o(a,b){var d=Object.prototype.toString.call(b).slice(8,-1);return b!==l&&b!==null&&d===a}function c(a){return o("Function",a)}function e(a){a=a||m;if(!a._done)a(),a._done=1}function h(a){var b={};if(typeof a==="object")for(var d in a)a[d]&&(b={name:d,url:a[d]});else b=a.split("/"),b=b[b.length-1],d=b.indexOf("?"),b={name:d!==-1?b.substring(0,
d):b,url:a};return(a=r[b.name])&&a.url===b.url?a:r[b.name]=b}function k(a){var a=a||r,b;for(b in a)if(a.hasOwnProperty(b)&&a[b].state!==s)return false;return true}function D(a){a.state=E;i(a.onpreload,function(a){a.call()})}function F(a){if(a.state===l)a.state=w,a.onpreload=[],x({url:a.url,type:"cache"},function(){D(a)})}function t(a,b){b=b||m;a.state===s?b():a.state===y?g.ready(a.name,b):a.state===w?a.onpreload.push(function(){t(a,b)}):(a.state=y,x(a,function(){a.state=s;b();i(q[a.name],function(a){e(a)});
p&&k()&&i(q.ALL,function(a){e(a)})}))}function x(a,b){var b=b||m,d;/\.css[^\.]*$/.test(a.url)?(d=j.createElement("link"),d.type="text/"+(a.type||"css"),d.rel="stylesheet",d.href=a.url):(d=j.createElement("script"),d.type="text/"+(a.type||"javascript"),d.src=a.url);d.onload=d.onreadystatechange=function(a){a=a||f.event;if(a.type==="load"||/loaded|complete/.test(d.readyState)&&(!j.documentMode||j.documentMode<9))d.onload=d.onreadystatechange=d.onerror=null,b()};d.onerror=function(){d.onload=d.onreadystatechange=
d.onerror=null;b()};d.async=false;d.defer=false;var e=j.head||j.getElementsByTagName("head")[0];e.insertBefore(d,e.lastChild)}function n(){j.body?p||(p=true,i(z,function(a){e(a)})):(f.clearTimeout(g.readyTimeout),g.readyTimeout=f.setTimeout(n,50))}function u(){j.addEventListener?(j.removeEventListener("DOMContentLoaded",u,false),n()):j.readyState==="complete"&&(j.detachEvent("onreadystatechange",u),n())}var j=f.document,z=[],A=[],q={},r={},G="async"in j.createElement("script")||"MozAppearance"in j.documentElement.style||
f.opera,B,p,C=f.head_conf&&f.head_conf.head||"head",g=f[C]=f[C]||function(){g.ready.apply(null,arguments)},w=1,E=2,y=3,s=4;g.load=G?function(){var a=arguments,b=a[a.length-1],d={};c(b)||(b=null);i(a,function(c,g){c!==b&&(c=h(c),d[c.name]=c,t(c,b&&g===a.length-2?function(){k(d)&&e(b)}:null))});return g}:function(){var a=arguments,b=[].slice.call(a,1),d=b[0];if(!B)return A.push(function(){g.load.apply(null,a)}),g;d?(i(b,function(a){c(a)||F(h(a))}),t(h(a[0]),c(d)?d:function(){g.load.apply(null,b)})):
t(h(a[0]));return g};g.js=g.load;g.test=function(a,b,d,c){a=typeof a==="object"?a:{test:a,success:b?o("Array",b)?b:[b]:false,failure:d?o("Array",d)?d:[d]:false,callback:c||m};(b=!!a.test)&&a.success?(a.success.push(a.callback),g.load.apply(null,a.success)):!b&&a.failure?(a.failure.push(a.callback),g.load.apply(null,a.failure)):c();return g};g.ready=function(a,b){if(a===j)return p?e(b):z.push(b),g;c(a)&&(b=a,a="ALL");if(typeof a!=="string"||!c(b))return g;var d=r[a];if(d&&d.state===s||a==="ALL"&&k()&&
p)return e(b),g;(d=q[a])?d.push(b):q[a]=[b];return g};g.ready(j,function(){k()&&i(q.ALL,function(a){e(a)});g.feature&&g.feature("domloaded",true)});if(j.readyState==="complete")n();else if(j.addEventListener)j.addEventListener("DOMContentLoaded",u,false),f.addEventListener("load",n,false);else{j.attachEvent("onreadystatechange",u);f.attachEvent("onload",n);var v=false;try{v=f.frameElement==null&&j.documentElement}catch(H){}v&&v.doScroll&&function b(){if(!p){try{v.doScroll("left")}catch(d){f.clearTimeout(g.readyTimeout);
g.readyTimeout=f.setTimeout(b,50);return}n()}}()}setTimeout(function(){B=true;i(A,function(b){b()})},300)})(window);
(function(){var f;typeof head!="undefined"&&(f=function(){return function(c,e){c.push(e);return head.js.apply(head.js,c)}});typeof YUI!="undefined"&&(f=function(){var c;YUI().use("get",function(e){c=e});c.Get.options.async=true;return function(){c.Get.js.apply(c.Get,arguments)}});typeof yepnope!="undefined"&&(f=function(){return function(c,e){var h=c[c.length-1];yepnope({load:c,callback:function(c){h==c&&e()}})}});typeof requirejs!="undefined"&&(f=function(){return function(c,e){requirejs(c,e)}});
var l;typeof $LAB!="undefined"&&(l=function(){var c=$LAB.sandbox();this.script=function(e){c=c.script(e);return this};this.wait=function(e){c=e?c.wait(e):c.wait();return this}});l||(l=function(){var c=null,e=[],h=false,k=f(),i=function(){if(!h&&(h=e.shift()))if(h.uris.length)k(h.uris,function(c){var e=h.callback;h=false;e&&e(c);i()});else{var c=h.callback;h=false;c&&c();i()}};this.script=function(h){c&&clearTimeout(c);e.length||e.push({uris:[],callback:false});e[e.length-1].uris.push(h);c=setTimeout(i,
1);return this};this.wait=function(c){var f=e.length?e[e.length-1]:false;h&&(f=h);if(!f)return c&&c(),this;f.callback?e.push({uris:[],callback:c}):(f.callback=c,e.push({uris:[],callback:false}));return this}});l.prototype.fork=function(){return new l};l.prototype.base=function(c){for(var e=document.getElementsByTagName("script"),h,c=RegExp(c),f=0,i;f<e.length;i=e[f].getAttribute("src"),f++)if(i&&c.test(i)){h=i.split("/");h.pop();h=h.join("/")||"./";break}return h};var m=1,i=null;l.prototype.style=
function(c,e){var f=document.getElementsByTagName("head")[0],k=document.createElement("link");k.setAttribute("type","text/css");k.setAttribute("rel","stylesheet");k.setAttribute("data-spitfire-index",m);e&&k.setAttribute("media",e);k.setAttribute("href",c);if(!i)i=f.lastChild;!i||!i.nextSibling?f.appendChild(k):f.insertBefore(k,i.nextSibling);i=k;m++};var o=typeof define==="function"&&define.amd;if(o||typeof exports=="object"&&exports)o&&define("Spitfire/loader",new l);else{if(!("Spitfire"in this))this.Spitfire=
{};this.Spitfire.loader=new l}}).apply(this);
