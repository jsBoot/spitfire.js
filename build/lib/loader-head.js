!function(win,undefined){"use strict";function pushClass(name){klass[klass.length]=name}function removeClass(name){var re=new RegExp(" ?\\b"+name+"\\b");html.className=html.className.replace(re,"")}function each(arr,fn){for(var i=0,l=arr.length;l>i;i++)fn.call(arr,arr[i],i)}function screenSize(){html.className=html.className.replace(/ (w-|eq-|gt-|gte-|lt-|lte-|portrait|no-portrait|landscape|no-landscape)\d+/g,"");var iw=win.innerWidth||html.clientWidth,ow=win.outerWidth||win.screen.width;api.screen.innerWidth=iw,api.screen.outerWidth=ow,pushClass("w-"+iw),each(conf.screens,function(width){iw>width?(conf.screensCss.gt&&pushClass("gt-"+width),conf.screensCss.gte&&pushClass("gte-"+width)):width>iw?(conf.screensCss.lt&&pushClass("lt-"+width),conf.screensCss.lte&&pushClass("lte-"+width)):iw===width&&(conf.screensCss.lte&&pushClass("lte-"+width),conf.screensCss.eq&&pushClass("e-q"+width),conf.screensCss.gte&&pushClass("gte-"+width))});var ih=win.innerHeight||html.clientHeight,oh=win.outerHeight||win.screen.height;api.screen.innerHeight=ih,api.screen.outerHeight=oh,api.feature("portrait",ih>iw),api.feature("landscape",iw>ih)}function onResize(){win.clearTimeout(resizeId),resizeId=win.setTimeout(screenSize,50)}var doc=win.document,nav=win.navigator,loc=win.location,html=doc.documentElement,klass=[],conf={screens:[240,320,480,640,768,800,1024,1280,1440,1680,1920],screensCss:{gt:!0,gte:!1,lt:!0,lte:!1,eq:!1},browsers:[{ie:{min:6,max:11}}],browserCss:{gt:!0,gte:!1,lt:!0,lte:!1,eq:!0},html5:!0,page:"-page",section:"-section",head:"head"};if(win.head_conf)for(var item in win.head_conf)win.head_conf[item]!==undefined&&(conf[item]=win.head_conf[item]);var api=win[conf.head]=function(){api.ready.apply(null,arguments)};api.feature=function(key,enabled,queue){return key?("[object Function]"===Object.prototype.toString.call(enabled)&&(enabled=enabled.call()),pushClass((enabled?"":"no-")+key),api[key]=!!enabled,queue||(removeClass("no-"+key),removeClass(key),api.feature()),api):(html.className+=" "+klass.join(" "),klass=[],api)},api.feature("js",!0);var ua=nav.userAgent.toLowerCase(),mobile=/mobile|android|kindle|silk|midp|phone|(windows .+arm|touch)/.test(ua);api.feature("mobile",mobile,!0),api.feature("desktop",!mobile,!0),ua=/(chrome|firefox)[ \/]([\w.]+)/.exec(ua)||/(iphone|ipad|ipod)(?:.*version)?[ \/]([\w.]+)/.exec(ua)||/(android)(?:.*version)?[ \/]([\w.]+)/.exec(ua)||/(webkit|opera)(?:.*version)?[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||/(trident).+rv:(\w.)+/.exec(ua)||[];var browser=ua[1],version=parseFloat(ua[2]);switch(browser){case"msie":case"trident":browser="ie",version=doc.documentMode||version;break;case"firefox":browser="ff";break;case"ipod":case"ipad":case"iphone":browser="ios";break;case"webkit":browser="safari"}api.browser={name:browser,version:version},api.browser[browser]=!0;for(var i=0,l=conf.browsers.length;l>i;i++)for(var key in conf.browsers[i])if(browser===key){pushClass(key);for(var min=conf.browsers[i][key].min,max=conf.browsers[i][key].max,v=min;max>=v;v++)version>v?(conf.browserCss.gt&&pushClass("gt-"+key+v),conf.browserCss.gte&&pushClass("gte-"+key+v)):v>version?(conf.browserCss.lt&&pushClass("lt-"+key+v),conf.browserCss.lte&&pushClass("lte-"+key+v)):version===v&&(conf.browserCss.lte&&pushClass("lte-"+key+v),conf.browserCss.eq&&pushClass("eq-"+key+v),conf.browserCss.gte&&pushClass("gte-"+key+v))}else pushClass("no-"+key);pushClass(browser),pushClass(browser+parseInt(version,10)),conf.html5&&"ie"===browser&&9>version&&each("abbr|article|aside|audio|canvas|details|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|progress|section|summary|time|video".split("|"),function(el){doc.createElement(el)}),each(loc.pathname.split("/"),function(el,i){if(this.length>2&&this[i+1]!==undefined)i&&pushClass(this.slice(i,i+1).join("-").toLowerCase()+conf.section);else{var id=el||"index",index=id.indexOf(".");index>0&&(id=id.substring(0,index)),html.id=id.toLowerCase()+conf.page,i||pushClass("root"+conf.section)}}),api.screen={height:win.screen.height,width:win.screen.width},screenSize();var resizeId=0;win.addEventListener?win.addEventListener("resize",onResize,!1):win.attachEvent("onresize",onResize)}(window),function(win,undefined){"use strict";function testProps(props){for(var i in props)if(style[props[i]]!==undefined)return!0;return!1}function testAll(prop){var camel=prop.charAt(0).toUpperCase()+prop.substr(1),props=(prop+" "+domPrefs.join(camel+" ")+camel).split(" ");return!!testProps(props)}var doc=win.document,el=doc.createElement("i"),style=el.style,prefs=" -o- -moz- -ms- -webkit- -khtml- ".split(" "),domPrefs="Webkit Moz O ms Khtml".split(" "),headVar=win.head_conf&&win.head_conf.head||"head",api=win[headVar],tests={gradient:function(){var s1="background-image:",s2="gradient(linear,left top,right bottom,from(#9f9),to(#fff));",s3="linear-gradient(left top,#eee,#fff);";return style.cssText=(s1+prefs.join(s2+s1)+prefs.join(s3+s1)).slice(0,-s1.length),!!style.backgroundImage},rgba:function(){return style.cssText="background-color:rgba(0,0,0,0.5)",!!style.backgroundColor},opacity:function(){return""===el.style.opacity},textshadow:function(){return""===style.textShadow},multiplebgs:function(){style.cssText="background:url(https://),url(https://),red url(https://)";var result=(style.background||"").match(/url/g);return"[object Array]"===Object.prototype.toString.call(result)&&3===result.length},boxshadow:function(){return testAll("boxShadow")},borderimage:function(){return testAll("borderImage")},borderradius:function(){return testAll("borderRadius")},cssreflections:function(){return testAll("boxReflect")},csstransforms:function(){return testAll("transform")},csstransitions:function(){return testAll("transition")},touch:function(){return"ontouchstart"in win},retina:function(){return win.devicePixelRatio>1},fontface:function(){var browser=api.browser.name,version=api.browser.version;switch(browser){case"ie":return version>=9;case"chrome":return version>=13;case"ff":return version>=6;case"ios":return version>=5;case"android":return!1;case"webkit":return version>=5.1;case"opera":return version>=10;default:return!1}}};for(var key in tests)tests[key]&&api.feature(key,tests[key].call(),!0);api.feature()}(window),function(win,undefined){"use strict";function noop(){}function each(arr,callback){if(arr){"object"==typeof arr&&(arr=[].slice.call(arr));for(var i=0,l=arr.length;l>i;i++)callback.call(arr,arr[i],i)}}function is(type,obj){var clas=Object.prototype.toString.call(obj).slice(8,-1);return obj!==undefined&&null!==obj&&clas===type}function isFunction(item){return is("Function",item)}function isArray(item){return is("Array",item)}function toLabel(url){var items=url.split("/"),name=items[items.length-1],i=name.indexOf("?");return-1!==i?name.substring(0,i):name}function one(callback){callback=callback||noop,callback._done||(callback(),callback._done=1)}function conditional(test,success,failure,callback){var obj="object"==typeof test?test:{test:test,success:success?isArray(success)?success:[success]:!1,failure:failure?isArray(failure)?failure:[failure]:!1,callback:callback||noop},passed=!!obj.test;return passed&&obj.success?(obj.success.push(obj.callback),api.load.apply(null,obj.success)):!passed&&obj.failure?(obj.failure.push(obj.callback),api.load.apply(null,obj.failure)):callback(),api}function getAsset(item){var asset={};if("object"==typeof item)for(var label in item)item[label]&&(asset={name:label,url:item[label]});else asset={name:toLabel(item),url:item};var existing=assets[asset.name];return existing&&existing.url===asset.url?existing:(assets[asset.name]=asset,asset)}function allLoaded(items){items=items||assets;for(var name in items)if(items.hasOwnProperty(name)&&items[name].state!==LOADED)return!1;return!0}function onPreload(asset){asset.state=PRELOADED,each(asset.onpreload,function(afterPreload){afterPreload.call()})}function preLoad(asset){asset.state===undefined&&(asset.state=PRELOADING,asset.onpreload=[],loadAsset({url:asset.url,type:"cache"},function(){onPreload(asset)}))}function apiLoadHack(){var args=arguments,callback=args[args.length-1],rest=[].slice.call(args,1),next=rest[0];return isFunction(callback)||(callback=null),isArray(args[0])?(args[0].push(callback),api.load.apply(null,args[0]),api):(next?(each(rest,function(item){!isFunction(item)&&item&&preLoad(getAsset(item))}),load(getAsset(args[0]),isFunction(next)?next:function(){api.load.apply(null,rest)})):load(getAsset(args[0])),api)}function apiLoadAsync(){var args=arguments,callback=args[args.length-1],items={};return isFunction(callback)||(callback=null),isArray(args[0])?(args[0].push(callback),api.load.apply(null,args[0]),api):(each(args,function(item){item!==callback&&(item=getAsset(item),items[item.name]=item)}),each(args,function(item){item!==callback&&(item=getAsset(item),load(item,function(){allLoaded(items)&&one(callback)}))}),api)}function load(asset,callback){return callback=callback||noop,asset.state===LOADED?(callback(),void 0):asset.state===LOADING?(api.ready(asset.name,callback),void 0):asset.state===PRELOADING?(asset.onpreload.push(function(){load(asset,callback)}),void 0):(asset.state=LOADING,loadAsset(asset,function(){asset.state=LOADED,callback(),each(handlers[asset.name],function(fn){one(fn)}),isDomReady&&allLoaded()&&each(handlers.ALL,function(fn){one(fn)})}),void 0)}function getExtension(url){url=url||"";var items=url.split("?")[0].split(".");return items[items.length-1].toLowerCase()}function loadAsset(asset,callback){function error(event){event=event||win.event,ele.onload=ele.onreadystatechange=ele.onerror=null,callback()}function process(event){event=event||win.event,("load"===event.type||/loaded|complete/.test(ele.readyState)&&(!doc.documentMode||doc.documentMode<9))&&(win.clearTimeout(asset.errorTimeout),win.clearTimeout(asset.cssTimeout),ele.onload=ele.onreadystatechange=ele.onerror=null,callback())}function isCssLoaded(){if(asset.state!==LOADED&&asset.cssRetries<=20){for(var i=0,l=doc.styleSheets.length;l>i;i++)if(doc.styleSheets[i].href===ele.href)return process({type:"load"}),void 0;asset.cssRetries++,asset.cssTimeout=win.setTimeout(isCssLoaded,250)}}callback=callback||noop;var ele,ext=getExtension(asset.url);"css"===ext?(ele=doc.createElement("link"),ele.type="text/"+(asset.type||"css"),ele.rel="stylesheet",ele.href=asset.url,asset.cssRetries=0,asset.cssTimeout=win.setTimeout(isCssLoaded,500)):(ele=doc.createElement("script"),ele.type="text/"+(asset.type||"javascript"),ele.src=asset.url),ele.onload=ele.onreadystatechange=process,ele.onerror=error,ele.async=!1,ele.defer=!1,asset.errorTimeout=win.setTimeout(function(){error({type:"timeout"})},7e3);var head=doc.head||doc.getElementsByTagName("head")[0];head.insertBefore(ele,head.lastChild)}function init(){for(var items=doc.getElementsByTagName("script"),i=0,l=items.length;l>i;i++){var dataMain=items[i].getAttribute("data-headjs-load");if(dataMain)return api.load(dataMain),void 0}}function ready(key,callback){if(key===doc)return isDomReady?one(callback):domWaiters.push(callback),api;if(isFunction(key)&&(callback=key,key="ALL"),isArray(key)){var items={};return each(key,function(item){items[item]=assets[item],api.ready(item,function(){allLoaded(items)&&one(callback)})}),api}if("string"!=typeof key||!isFunction(callback))return api;var asset=assets[key];if(asset&&asset.state===LOADED||"ALL"===key&&allLoaded()&&isDomReady)return one(callback),api;var arr=handlers[key];return arr?arr.push(callback):arr=handlers[key]=[callback],api}function domReady(){return doc.body?(isDomReady||(isDomReady=!0,init(),each(domWaiters,function(fn){one(fn)})),void 0):(win.clearTimeout(api.readyTimeout),api.readyTimeout=win.setTimeout(domReady,50),void 0)}function domContentLoaded(){doc.addEventListener?(doc.removeEventListener("DOMContentLoaded",domContentLoaded,!1),domReady()):"complete"===doc.readyState&&(doc.detachEvent("onreadystatechange",domContentLoaded),domReady())}var isDomReady,doc=win.document,domWaiters=[],handlers={},assets={},isAsync="async"in doc.createElement("script")||"MozAppearance"in doc.documentElement.style||win.opera,headVar=win.head_conf&&win.head_conf.head||"head",api=win[headVar]=win[headVar]||function(){api.ready.apply(null,arguments)},PRELOADING=1,PRELOADED=2,LOADING=3,LOADED=4;if("complete"===doc.readyState)domReady();else if(doc.addEventListener)doc.addEventListener("DOMContentLoaded",domContentLoaded,!1),win.addEventListener("load",domReady,!1);else{doc.attachEvent("onreadystatechange",domContentLoaded),win.attachEvent("onload",domReady);var top=!1;try{top=!win.frameElement&&doc.documentElement}catch(e){}top&&top.doScroll&&!function doScrollCheck(){if(!isDomReady){try{top.doScroll("left")}catch(error){return win.clearTimeout(api.readyTimeout),api.readyTimeout=win.setTimeout(doScrollCheck,50),void 0}domReady()}}()}api.load=api.js=isAsync?apiLoadAsync:apiLoadHack,api.test=conditional,api.ready=ready,api.ready(doc,function(){allLoaded()&&each(handlers.ALL,function(callback){one(callback)}),api.feature&&api.feature("domloaded",!0)})}(window),function(){"use strict";var backend;"undefined"!=typeof head&&(backend=function(){return function(uris,callback){return uris.push(callback),head.js.apply(head.js,uris)}}),"undefined"!=typeof YUI&&(backend=function(){var Y;return YUI().use("get",function(o){Y=o,Y.Get.options.async=!0}),function(){Y.Get.js.apply(Y.Get,arguments)}}),"undefined"!=typeof yepnope&&(backend=function(){return function(uris,callback){var stamp=uris[uris.length-1];yepnope({load:uris,callback:function(url){stamp==url&&callback()}})}}),"undefined"!=typeof requirejs&&(backend=function(){return function(uris,callback){requirejs(uris,callback)}});var PvLoader;"undefined"!=typeof $LAB&&(PvLoader=function(){var q=$LAB.sandbox();this.script=function(uri){return q=q.script(uri),this},this.wait=function(cbk){return q=cbk?q.wait(cbk):q.wait(),this}}),PvLoader||(PvLoader=function(){var linger=null,toLoad=[],currentLoading=!1,bck=backend(),lingerEnd=function(){if(!currentLoading&&(currentLoading=toLoad.shift())){if(!currentLoading.uris.length){var cl=currentLoading.callback;return currentLoading=!1,cl&&cl(),lingerEnd(),void 0}bck(currentLoading.uris,function(err){var cl=currentLoading.callback;currentLoading=!1,cl&&cl(err),lingerEnd()})}};this.script=function(uri){return linger&&clearTimeout(linger),toLoad.length||toLoad.push({uris:[],callback:!1}),toLoad[toLoad.length-1].uris.push(uri),linger=setTimeout(lingerEnd,1),this},this.wait=function(callback){var me=toLoad.length?toLoad[toLoad.length-1]:!1;return currentLoading&&(me=currentLoading),me?(me.callback?toLoad.push({uris:[],callback:callback}):(me.callback=callback,toLoad.push({uris:[],callback:!1})),this):(callback&&callback(),this)}}),PvLoader.prototype.fork=function(){return new PvLoader},PvLoader.prototype.base=function(pattern){for(var m,it,c=document.getElementsByTagName("script"),re=new RegExp(pattern),x=0;x<c.length;it=c[x].getAttribute("src"),x++)if(re.test(it)){m=it.split("/"),m.pop(),m=m.join("/")||".";break}return m||null};var idx=1,hook=null;PvLoader.prototype.style=function(url,media){var h=document.getElementsByTagName("head")[0],s=document.createElement("link");s.setAttribute("type","text/css"),s.setAttribute("rel","stylesheet"),s.setAttribute("data-spitfire-index",idx),media&&s.setAttribute("media",media),s.setAttribute("href",url),hook||(hook=h.lastChild),hook&&hook.nextSibling?h.insertBefore(s,hook.nextSibling):h.appendChild(s),hook=s,idx++};var isLoader="function"==typeof define&&define.amd,root="object"==typeof exports&&exports;isLoader||root?isLoader&&define("Spitfire/loader",new PvLoader):("Spitfire"in this||(this.Spitfire={}),this.Spitfire.loader=new PvLoader)}.apply(this);
//# sourceMappingURL=loader-head.js.map